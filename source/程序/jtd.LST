C51 COMPILER V9.52.0.0   JTD                                                               03/17/2019 20:36:56 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE JTD
OBJECT MODULE PLACED IN jtd.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE jtd.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include <reg51.h>        //ͷļ
   2          #define uchar unsigned char
   3          #define uint  unsigned int    //궨
   4          
   5          uchar  buf[4];          //ʾı
   6          uchar  sec_dx=20;       //Ĭ
   7          uchar  sec_nb=30;     //ϱĬֵ
   8          float  set_timedx=20;   //öʱ
   9          float  set_timenb=30;   //ϱʱ
  10          int n;
  11          uchar data countt0,countt1,flag,flag1,flag2,count2,flag3,flag5;//ʱ0жϴ
  12          //6鿪
  13          sbit  k3=P3^4;    //ȷ
  14          sbit  k5=P3^1;    //ֹ
  15          sbit  k6=P1^5;    //ҹģʽ
  16          sbit  k7=P3^7;      //⣬ģʽ
  17          sbit  k8=P3^5;      //
  18          sbit  k9=P3^6;    //ϱ
  19          
  20          sbit BUZZ=P3^0;
  21          
  22          sbit Red_nb=P2^6;   //ϱƱ־
  23          sbit Yellow_nb=P2^5;  //ϱƵƱ־
  24          sbit Green_nb=P2^4;     //ϱ̵Ʊ־
  25          
  26          sbit Red_dx=P2^3;   //Ʊ־
  27          sbit Yellow_dx=P2^2;  //ƵƱ־
  28          sbit Green_dx=P2^1;   //̵Ʊ־
  29              
  30          bit set=0;        //ʱл־ =1ʱϱ=0ʱ
  31          bit dx_nb=0;      //ϱλ
  32          bit shanruo=0;      //˸־λ
  33          bit yejian=0;     //ҹƵ˸־λ
  34          
  35          uchar code table[11]={  //
  36            0x3f,  //--0
  37            0x06,  //--1
  38            0x5b,  //--2
  39            0x4f,  //--3
  40            0x66,  //--4
  41            0x6d,  //--5
  42            0x7d,  //--6
  43            0x07,  //--7
  44            0x7f,  //--8
  45            0x6f,  //--9
  46            0x00   //--NULL
  47          };
  48          
  49          //
  50          void delay(int ms);     //ʱӳ
  51          void key();         //ɨӳ
  52          void key_to1();       //ӳ
  53          void key_to2();
  54          void key_to3();
  55          void display();       //ʾӳ
C51 COMPILER V9.52.0.0   JTD                                                               03/17/2019 20:36:56 PAGE 2   

  56          void logo();          //LOGO
  57          void Buzzer();
  58          //
  59          void main()
  60          {
  61   1        TMOD=0X11;            //ʱ
  62   1        TH1=0X3C;   
  63   1        TL1=0XB0;
  64   1        TH0=0X3C;         //ʱ0óֵ 0.05S
  65   1        TL0=0XB0;
  66   1        EA=1;           //ж
  67   1        ET0=1;            //ʱ0жϿ
  68   1        ET1=1;             //ʱ1жϿ
  69   1        TR0=1;            //ʱ0
  70   1        TR1=0;              //رնʱ1
  71   1        EX0=1;            //ⲿж0
  72   1        EX1=1;            //ⲿж1
  73   1          logo();           //ʼ
  74   1        P2=0Xc3;        // ʼĬ״̵̬ƣϱƵ   
  75   1          sec_nb=sec_dx+5;      //Ĭϱͨʱȶ5
  76   1        while(1)            //ѭ
  77   1        {  
  78   2          key();          //ðɨ
  79   2          display();        //ʾ
  80   2        } 
  81   1      }
  82          //Ķ岿
  83            if(k3!=1)             //K3ȷϣʱ
*** ERROR C141 IN LINE 83 OF jtd.c: syntax error near 'if'
*** ERROR C141 IN LINE 83 OF jtd.c: syntax error near '!=', expected ')'
  84            { 
  85              display();              //ʾʱ
*** ERROR C231 IN LINE 85 OF jtd.c: 'display': redefinition
  86              if(k3!=1)           //ȷ
*** ERROR C141 IN LINE 86 OF jtd.c: syntax error near 'if'
*** ERROR C141 IN LINE 86 OF jtd.c: syntax error near '!=', expected ')'
  87              { flag=0;
*** ERROR C231 IN LINE 87 OF jtd.c: 'flag': redefinition
  88                TR0=1;              //ʱ0
*** ERROR C231 IN LINE 88 OF jtd.c: 'TR0': redefinition
*** ERROR C231 IN LINE 88 OF jtd.c: 'TR0': redefinition
  89                flag3=0;
*** ERROR C231 IN LINE 89 OF jtd.c: 'flag3': redefinition
  90                TR1=1;
*** ERROR C231 IN LINE 90 OF jtd.c: 'TR1': redefinition
*** ERROR C231 IN LINE 90 OF jtd.c: 'TR1': redefinition
  91                sec_nb=set_timenb;        //жϻظʾùֵ
*** ERROR C279 IN LINE 91 OF jtd.c: 'sec_nb': multiple initialization
*** ERROR C231 IN LINE 91 OF jtd.c: 'sec_nb': redefinition
*** ERROR C247 IN LINE 91 OF jtd.c: non-address/-constant initializer
  92                sec_dx=set_timedx;        //ʾùʱ
*** ERROR C279 IN LINE 92 OF jtd.c: 'sec_dx': multiple initialization
*** ERROR C231 IN LINE 92 OF jtd.c: 'sec_dx': redefinition
*** ERROR C247 IN LINE 92 OF jtd.c: non-address/-constant initializer
  93                              //ضʱ1 
  94                if(set==0)            //ʱ䵹ʱ0ʱ
*** ERROR C141 IN LINE 94 OF jtd.c: syntax error near 'if'
*** ERROR C141 IN LINE 94 OF jtd.c: syntax error near '==', expected ')'
  95                { 
  96                  P2=0X00;           //ʾ
*** ERROR C231 IN LINE 96 OF jtd.c: 'P2': redefinition
*** ERROR C231 IN LINE 96 OF jtd.c: 'P2': redefinition
C51 COMPILER V9.52.0.0   JTD                                                               03/17/2019 20:36:56 PAGE 3   

  97                  Green_dx=1;           //̵
*** ERROR C231 IN LINE 97 OF jtd.c: 'Green_dx': redefinition
*** ERROR C231 IN LINE 97 OF jtd.c: 'Green_dx': redefinition
  98                  Red_nb=1;         //ϱ
*** ERROR C231 IN LINE 98 OF jtd.c: 'Red_nb': redefinition
*** ERROR C231 IN LINE 98 OF jtd.c: 'Red_nb': redefinition
  99                  sec_nb=sec_dx+5;      //صֵ
*** ERROR C279 IN LINE 99 OF jtd.c: 'sec_nb': multiple initialization
*** ERROR C247 IN LINE 99 OF jtd.c: non-address/-constant initializer
 100                }
*** ERROR C141 IN LINE 100 OF jtd.c: syntax error near '}'
 101                else 
 102                { 
 103                  P2=0x00;          //ϱ̵ƣ
*** ERROR C279 IN LINE 103 OF jtd.c: 'P2': multiple initialization
*** ERROR C231 IN LINE 103 OF jtd.c: 'P2': redefinition
*** ERROR C231 IN LINE 103 OF jtd.c: 'P2': redefinition
 104                  Green_nb=1;
*** ERROR C231 IN LINE 104 OF jtd.c: 'Green_nb': redefinition
*** ERROR C231 IN LINE 104 OF jtd.c: 'Green_nb': redefinition
 105                  Red_dx=1;
*** ERROR C231 IN LINE 105 OF jtd.c: 'Red_dx': redefinition
*** ERROR C231 IN LINE 105 OF jtd.c: 'Red_dx': redefinition
 106                  sec_dx=sec_nb+5; 
*** ERROR C279 IN LINE 106 OF jtd.c: 'sec_dx': multiple initialization
*** ERROR C247 IN LINE 106 OF jtd.c: non-address/-constant initializer
 107                }
*** ERROR C141 IN LINE 107 OF jtd.c: syntax error near '}'
 108              }
 109            }
 110            if(k5!=1)             //K5ֹʱ
*** ERROR C141 IN LINE 110 OF jtd.c: syntax error near '!=', expected ')'
 111            {
 112                display();              //ʾʱ
*** ERROR C231 IN LINE 112 OF jtd.c: 'display': redefinition
 113                if(k5!=1)           //ȷ
*** ERROR C141 IN LINE 113 OF jtd.c: syntax error near 'if'
*** ERROR C141 IN LINE 113 OF jtd.c: syntax error near '!=', expected ')'
 114                {     flag3=0;
*** ERROR C279 IN LINE 114 OF jtd.c: 'flag3': multiple initialization
 115              flag5=1-flag5;
*** ERROR C231 IN LINE 115 OF jtd.c: 'flag5': redefinition
*** ERROR C247 IN LINE 115 OF jtd.c: non-address/-constant initializer
 116                if(flag5==1)
*** ERROR C141 IN LINE 116 OF jtd.c: syntax error near 'if'
*** ERROR C141 IN LINE 116 OF jtd.c: syntax error near '==', expected ')'
 117                { TR0=0;            //ضʱ
*** ERROR C279 IN LINE 117 OF jtd.c: 'TR0': multiple initialization
*** ERROR C231 IN LINE 117 OF jtd.c: 'TR0': redefinition
*** ERROR C231 IN LINE 117 OF jtd.c: 'TR0': redefinition
 118                P2=0x00;          //ʾ
*** ERROR C279 IN LINE 118 OF jtd.c: 'P2': multiple initialization
*** ERROR C231 IN LINE 118 OF jtd.c: 'P2': redefinition
*** ERROR C231 IN LINE 118 OF jtd.c: 'P2': redefinition
 119                Red_dx=1;
*** ERROR C279 IN LINE 119 OF jtd.c: 'Red_dx': multiple initialization
*** ERROR C231 IN LINE 119 OF jtd.c: 'Red_dx': redefinition
*** ERROR C231 IN LINE 119 OF jtd.c: 'Red_dx': redefinition
 120                Red_nb=1;     }   //ȫú  
*** ERROR C279 IN LINE 120 OF jtd.c: 'Red_nb': multiple initialization
*** ERROR C231 IN LINE 120 OF jtd.c: 'Red_nb': redefinition
*** ERROR C231 IN LINE 120 OF jtd.c: 'Red_nb': redefinition
C51 COMPILER V9.52.0.0   JTD                                                               03/17/2019 20:36:56 PAGE 4   

*** ERROR C141 IN LINE 120 OF jtd.c: syntax error near '}'
 121                if(flag5==0)
*** ERROR C141 IN LINE 121 OF jtd.c: syntax error near '==', expected ')'
 122          {       TR0=1;
*** ERROR C279 IN LINE 122 OF jtd.c: 'TR0': multiple initialization
*** ERROR C231 IN LINE 122 OF jtd.c: 'TR0': redefinition
*** ERROR C231 IN LINE 122 OF jtd.c: 'TR0': redefinition
 123                  P2=0X00;           //ʾ
*** ERROR C279 IN LINE 123 OF jtd.c: 'P2': multiple initialization
*** ERROR C231 IN LINE 123 OF jtd.c: 'P2': redefinition
*** ERROR C231 IN LINE 123 OF jtd.c: 'P2': redefinition
 124                  Green_dx=1;           //̵
*** ERROR C279 IN LINE 124 OF jtd.c: 'Green_dx': multiple initialization
*** ERROR C231 IN LINE 124 OF jtd.c: 'Green_dx': redefinition
*** ERROR C231 IN LINE 124 OF jtd.c: 'Green_dx': redefinition
 125                  Red_nb=1;         //ϱ
*** ERROR C279 IN LINE 125 OF jtd.c: 'Red_nb': multiple initialization
*** ERROR C231 IN LINE 125 OF jtd.c: 'Red_nb': redefinition
*** ERROR C231 IN LINE 125 OF jtd.c: 'Red_nb': redefinition
 126                  sec_dx=set_timedx;
*** ERROR C279 IN LINE 126 OF jtd.c: 'sec_dx': multiple initialization
*** ERROR C247 IN LINE 126 OF jtd.c: non-address/-constant initializer
 127                  sec_nb=sec_dx+5; }    //صֵ
*** ERROR C279 IN LINE 127 OF jtd.c: 'sec_nb': multiple initialization
*** ERROR C247 IN LINE 127 OF jtd.c: non-address/-constant initializer
*** ERROR C141 IN LINE 127 OF jtd.c: syntax error near '}'
 128                do
 129                {
 130                  display();        //ʾʱ
*** ERROR C231 IN LINE 130 OF jtd.c: 'display': redefinition
 131                } 
*** ERROR C141 IN LINE 131 OF jtd.c: syntax error near '}'
 132                while(k5!=1);     //ȴͷ  
*** ERROR C141 IN LINE 132 OF jtd.c: syntax error near '!=', expected ')'
 133                }
 134            }
 135            if(k6!=1)             //K6ҹģʽ 
*** ERROR C141 IN LINE 135 OF jtd.c: syntax error near '!=', expected ')'
 136            {
 137                display();              //ʾʱ 
*** ERROR C231 IN LINE 137 OF jtd.c: 'display': redefinition
 138                if(k6!=1)           //ȷ
*** ERROR C141 IN LINE 138 OF jtd.c: syntax error near 'if'
*** ERROR C141 IN LINE 138 OF jtd.c: syntax error near '!=', expected ')'
 139                {   
 140                  TR0=0;            //ضʱ
*** ERROR C279 IN LINE 140 OF jtd.c: 'TR0': multiple initialization
*** ERROR C231 IN LINE 140 OF jtd.c: 'TR0': redefinition
*** ERROR C231 IN LINE 140 OF jtd.c: 'TR0': redefinition
 141                P2=0x00;
*** ERROR C279 IN LINE 141 OF jtd.c: 'P2': multiple initialization
*** ERROR C231 IN LINE 141 OF jtd.c: 'P2': redefinition
*** ERROR C231 IN LINE 141 OF jtd.c: 'P2': redefinition
 142                flag3=1;
*** ERROR C279 IN LINE 142 OF jtd.c: 'flag3': multiple initialization
 143                sec_dx=00;          //ĸʱ䶼Ϊ00
*** ERROR C279 IN LINE 143 OF jtd.c: 'sec_dx': multiple initialization
 144                sec_nb=00;
*** ERROR C279 IN LINE 144 OF jtd.c: 'sec_nb': multiple initialization
 145                do
*** ERROR C141 IN LINE 145 OF jtd.c: syntax error near 'do'
 146                {
C51 COMPILER V9.52.0.0   JTD                                                               03/17/2019 20:36:56 PAGE 5   

 147                  display();        //ʾʱ
*** ERROR C231 IN LINE 147 OF jtd.c: 'display': redefinition
 148                } 
*** ERROR C141 IN LINE 148 OF jtd.c: syntax error near '}'
 149                while(k6!=1);     //ȴͷ  
*** ERROR C141 IN LINE 149 OF jtd.c: syntax error near '!=', expected ')'
 150                }
 151            }
 152            if(k7!=1)             //K6ҹģʽ 
*** ERROR C141 IN LINE 152 OF jtd.c: syntax error near '!=', expected ')'
 153            {
 154                display();              //ʾʱ 
*** ERROR C231 IN LINE 154 OF jtd.c: 'display': redefinition
 155                if(k7!=1)           //ȷ
*** ERROR C141 IN LINE 155 OF jtd.c: syntax error near 'if'
*** ERROR C141 IN LINE 155 OF jtd.c: syntax error near '!=', expected ')'
 156                {
 157                flag++;   
*** ERROR C129 IN LINE 157 OF jtd.c: missing ';' before '++'
 158                if(flag>=99)           
 159                flag=0;      //ģʽΧ
 160                if(flag==1)
 161                {
 162                  TR0=0;TR1=1;
 163                  sec_dx=set_timedx;
 164                  sec_nb=set_timenb;    //ʾõĳʼͨʱ
 165                  do  
 166                    { 
 167                    display();          //ʾʱ
 168                  }
 169                  
 170                  while(k7!=1); 
 171                }
 172                if(flag==2)
 173                {
 174                  TR0=0;TR1=1;
 175                  sec_dx=flag2;
 176                  sec_nb=flag1;         //ʾ
 177                  do  
 178                    { 
 179                    display();          //ʾʱ
 180                  }
 181                  while(k7!=1); 
 182                }
 183                }
 184            }
 185            if(k8!=1)             // 
 186            {
 187                display();              //ʾʱ 
 188                if(k8!=1)           //ȷ
 189                {
 190                if(Green_dx==1)
 191                {
 192                  flag2++;        //
 193                  if(flag2>=99)
 194                  flag2=0;  
 195                }
 196                else if(Red_dx==1)
 197                {
 198                  BUZZ=0;
 199                  countt1=0;
 200                }       
C51 COMPILER V9.52.0.0   JTD                                                               03/17/2019 20:36:56 PAGE 6   

 201                
 202                if(flag==0)
 203                {
 204                  do  
 205                  { 
 206                    display();          //ʾʱ
 207                  }
 208            
 209                  while(k8!=1);
 210                }
 211                if(flag==1)
 212                {
 213                  sec_dx=set_timedx;
 214                  sec_nb=set_timenb;         //ʾõͨʱ
 215                  do  
 216                  { 
 217                    display();          //ʾʱ
 218                  }
 219            
 220                  while(k8!=1);
 221                }
 222                if(flag==2)
 223                {
 224                  sec_nb=flag1;   //ʾ
 225                  sec_dx=flag2;  
 226                  do  
 227                  { 
 228                    display();          //ʾʱ
 229                  }
 230                  while(k8!=1); 
 231                }
 232              }
 233            }
 234            if(k9!=1)             //
 235            {
 236                display();              //ʾʱ 
 237                if(k9!=1)           //ȷ
 238                {
 239                if(Green_nb==1)
 240                {
 241                  flag1++;           //ϱ
 242                  if(flag1>=99)
 243                  flag1=0;  
 244                }
 245                else if(Red_nb==1)
 246                {
 247                  BUZZ=0;
 248                  countt1=0;
 249                }       
 250                             //99
 251                if(flag==0)
 252                {
 253                  do  
 254                  { 
 255                    display();          //ʾʱ
 256                  }
 257                
 258                  while(k9!=1);
 259                }
 260                if(flag==1)
 261                {
 262                  sec_nb=set_timenb;    //õֵϱ
C51 COMPILER V9.52.0.0   JTD                                                               03/17/2019 20:36:56 PAGE 7   

 263                  sec_dx=set_timedx;   
 264                  do  
 265                  { 
 266                    display();          //ʾʱ
 267                  }
 268                  while(k9!=1); 
 269                }
 270                if(flag==2)
 271                {
 272                  sec_nb=flag1;   //ĳϱ
 273                  sec_dx=flag2;  
 274                  do  
 275                  { 
 276                    display();          //ʾʱ
 277                  }
 278                  while(k9!=1); 
 279                }
 280                }
 281            }
 282          }
 283          void display(void) //ʾӳ
 284          {   
 285            buf[1]=sec_nb/10;     //1λ ʮλ
 286            buf[2]=sec_nb%10;     //2λ λ
 287            buf[3]=sec_dx/10;     //3λ ϱʮλ
 288            buf[0]=sec_dx%10;     //4λ ϱλ    
 289            P1=0xff;              // ʼΪ
 290            P0=0x00;         ////ʾ
 291            P1=0xfe;              //ƬѡLED1
 292            P0=table[buf[1]];   //Ͷʱʮλܱ      
 293            delay(1);       //ʱ
 294            P1=0xff;        //ʾ
 295            P0=0x00;        //ʾ
 296                         
 297            P1=0xfd;              //ƬѡLED2
 298            P0=table[buf[2]];    //Ͷʱλܱ
 299            delay(1);        //ʱ
 300            P1=0xff;        //ʾ
 301            P0=0x00;        //ʾ
 302            P1=0Xfb;          //ƬѡLED3
 303            P0=table[buf[3]];   //ϱʱʮλܱ
 304            delay(1);       //ʱ
 305            P1=0xff;         //ʾ
 306            P0=0x00;         //ʾ
 307            P1=0Xf7;         //ƬѡLED4 
 308            P0=table[buf[0]];   //ϱʱλܱ
 309            delay(1);       //ʱ
 310          }
 311          
 312          void time0(void) interrupt 1 using 1    //ʱжӳ
 313          {
 314            TH0=0X3C;             //ظֵ
 315            TL0=0XB0;             //12m50ms//ظֵ
 316            TR0=1;                //ʱ
 317            countt0++;              //1
 318            if(countt0==10)           //ӵ10Ҳǰ
 319            {
 320              if((sec_nb<=5)&&(dx_nb==0)&&(shanruo==1))     //Ƶ    
 321                  {
 322                Green_dx=0;
 323                Yellow_dx=0;
 324              }             
C51 COMPILER V9.52.0.0   JTD                                                               03/17/2019 20:36:56 PAGE 8   

 325                if((sec_dx<=5)&&(dx_nb==1)&&(shanruo==1))     //ϱƵ    
 326                  {  
 327                Green_nb=0;
 328                Yellow_nb=0;
 329              } 
 330            }
 331              
 332            if(countt0==20)                     // ʱжϴ=20ʱ1ʱ
 333            { countt0=0;            //
 334              sec_dx--;           //ʱ1
 335              sec_nb--;           //ϱʱ1
 336              
 337          //    BUZZ=1;
 338              if((sec_nb<=5)&&(dx_nb==0)&&(shanruo==1))     //Ƶ    
 339                  {
 340                Green_dx=0;
 341                Yellow_dx=1;
 342              }             
 343                if((sec_dx<=5)&&(dx_nb==1)&&(shanruo==1))     //ϱƵ    
 344                  {  
 345                Green_nb=0;
 346                Yellow_nb=1;
 347              }               
 348              if(sec_dx==0&&sec_nb==5)    //ʱ0ʱ5룬ڻƵ˸ʱ   
 349              {
 350                sec_dx=5;
 351                shanruo=1;
 352              }
 353              if(sec_nb==0&&sec_dx==5)    //ϱʱ0ʱ5룬ڻƵ˸ʱ   
 354              {
 355                sec_nb=5;
 356                shanruo=1;
 357              }
 358              if(dx_nb==0&&sec_nb==0)     //Ƶ˸ʱ䵹ʱ0ʱ
 359              {
 360                P2=0x00;          //öϱĺ̵
 361                Green_nb=1;
 362                Red_dx=1;
 363                dx_nb=!dx_nb;
 364                shanruo=0;
 365                                                                 
 366                if(flag1*10/set_timenb>=5)       //ͨʱ20룬ôͨĳڵ10ô´ͨʱ5
             -룬Ϊ25
 367                {set_timenb=set_timenb+5;}       //ͨʱ25룬ôͨĳڵ12.5ҲǴڵ13
             -ô´ͨʱͼ5룬Ϊ30
 368                else
 369                {                  //ͨʱ20룬ôͨĳС10ô´ͨʱ5룬Ϊ15
 370                  set_timenb=set_timenb-5;     //ͨʱ25룬ôͨĳС12.5ҲǴڵ13ô
             -´ͨʱͼ5룬Ϊ20
 371                  if(set_timenb<15)        //Ǽ޵ļСͨʱ15
 372                  {
 373                    set_timenb=15;
 374                  }
 375                }
 376                flag1=0;      
 377          
 378                sec_nb=set_timenb;      //ظϱʼֵ
 379                sec_dx=set_timenb+5;    //ظʼֵ
 380              }   
 381              if(dx_nb==1&&sec_dx==0)     //Ƶ˸ʱ䵽
 382              {
 383                P2=0X00;          //öϱĺ̵״̬
C51 COMPILER V9.52.0.0   JTD                                                               03/17/2019 20:36:56 PAGE 9   

 384                Green_dx=1;          //̵
 385                Red_nb=1;          //ϱ
 386                dx_nb=!dx_nb;        //ȡ
 387                shanruo=0;          //˸
 388          
 389                if(flag2*10/set_timedx>=5)     //ͨʱ20룬ôͨĳڵ10ô´ͨʱ5
             -Ϊ25
 390                {set_timedx=set_timedx+5;}     //ͨʱ25룬ôͨĳڵ12.5ҲǴڵ13
             -ô´ͨʱͼ5룬Ϊ30
 391                else
 392                {                //ͨʱ20룬ôͨĳС10ô´ͨʱ5룬Ϊ15
 393                  set_timedx=set_timedx-5;   //ͨʱ25룬ôͨĳС12.5ҲǴڵ13ô
             -ͨʱͼ5룬Ϊ20
 394                  if(set_timedx<15)      //Ǽ޵ļСͨʱ15
 395                  {
 396                    set_timedx=15;
 397                  }
 398                }
 399                flag2=0;
 400          
 401                sec_dx=set_timedx;      //ظʼֵ
 402                sec_nb=set_timedx+5;    //ظϱʼֵ
 403              }
 404            }
 405          }
 406          void time1(void) interrupt 3  //ʱжӳ
 407          {
 408            TH1=0X3C;             //ظֵ
 409            TL1=0XB0;             //12m50ms//ظֵ
 410            countt1++;              //1
 411            if(countt1==10)            // ʱжϴ=10ʱ0.5룩
 412            {    
 413              if(flag3==1)
 414                {
 415                Yellow_nb=0;        //ϱƵ
 416                Yellow_dx=0;        //Ƶ   
 417              } 
 418            }                                                                                                    
 419            if(countt1==20)                     // ʱжϴ=20ʱ1ʱ
 420            {     
 421              count2++;
 422              countt1=0;            //
 423              BUZZ=1;
 424              if(flag3==1)
 425              { 
 426                Yellow_nb=1;          //ϱƵ
 427                Yellow_dx=1;       
 428              }   //Ƶ
 429            }
 430          }
 431          
 432          
 433          //ⲿж0
 434          void int0(void) interrupt 0 using 1    //ֻͨ
 435          {
 436            TR0=0;                //ضʱ0
 437            TR1=1;flag3=0;                //ضʱ1
 438            P2=0x00;              //ʾ
 439            Green_dx=1;             //̵
 440            Red_nb=1;             //ϱΪ
 441            sec_dx=00;              //ĸʱ䶼Ϊ00
 442            sec_nb=00;  
C51 COMPILER V9.52.0.0   JTD                                                               03/17/2019 20:36:56 PAGE 10  

 443          }
 444          
 445          //ⲿж1
 446          void int1(void) interrupt 2 using 1      //ֻϱͨ 
 447          {
 448            TR0=0;                //ضʱ0
 449            TR1=1;flag3=0;                 //ضʱ1
 450            P2=0x00;              //ʾ
 451            Green_nb=1;             //ϱΪ̵
 452            Red_dx=1;             //Ϊ
 453            sec_nb=00;              //ĸʱ䶼Ϊ00
 454            sec_dx=00;
 455          }
 456          void logo()//Logo  "- - - -"
 457          { 
 458            for(n=0;n<50;n++) //ѭʾ----50
 459              {
 460                P0=0x40;  //Ρ-
 461                P1=0xfe;  //һλʾ
 462              delay(1); //ʱ
 463                P1=0xfd;  //ڶλʾ
 464              delay(1); //ʱ
 465              P1=0Xfb;  //λʾ
 466              delay(1); //ʱ
 467              P1=0Xf7;  //λʾ
 468              delay(1); //ʱ
 469                P1 = 0xff;  //ʾ
 470            }
 471          }
 472          
 473          void delay(int ms)    //ʱӳ
 474          {
 475            uint j,k;
 476            for(j=0;j<ms;j++)     //ʱms
 477               for(k=0;k<124;k++);    //Լ1ʱ
 478          }

C51 COMPILATION COMPLETE.  0 WARNING(S),  103 ERROR(S)
